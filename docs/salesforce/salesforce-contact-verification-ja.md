# Salesforce同期データ確認ガイド

このドキュメントでは、MarkMailから同期されたデータをSalesforceのWeb
UI上で確認する方法を説明します。

## Salesforceへのアクセス

### ログインURL

開発環境やSandbox環境の場合：

- Classic UI: `https://test.salesforce.com`
- 本番環境: `https://login.salesforce.com`

ログイン後、自動的にLightning ExperienceまたはClassic UIに遷移します。

### 組織固有のURL

sf CLIで確認した組織情報から、以下のURLが使用できます：

```bash
# 組織情報の確認
sf org display --target-org markmail-org
```

例：

- インスタンスURL: `https://customization-computing-9993.my.salesforce.com`
- Lightning URL: `https://customization-computing-9993.lightning.force.com`

## Lightning Experience（推奨）での確認方法

### 1. アプリランチャーからアクセス

1. 左上の **アプリランチャー**（9つの点のアイコン）をクリック
2. **セールス** または **サービス** アプリを選択
3. ナビゲーションバーから **取引先責任者** をクリック

### 2. グローバル検索を使用

1. 画面上部の **検索ボックス** に同期した名前（例：「John Doe」）を入力
2. 検索結果のドロップダウンから該当のレコードを選択
3. または「すべての結果を表示」をクリックして詳細検索

### 3. リストビューから確認

1. **取引先責任者** タブを開く
2. リストビューのドロップダウンから以下を選択：
   - 「すべての取引先責任者」
   - 「最近参照した取引先責任者」
   - 「最近作成した取引先責任者」

### 4. 直接URLでアクセス

同期レスポンスで取得したSalesforce IDを使用：

```
https://[インスタンス].lightning.force.com/lightning/r/Contact/[レコードID]/view
```

例：

```
https://customization-computing-9993.lightning.force.com/lightning/r/Contact/003IR00001lSWSjYAO/view
```

## Classic UIでの確認方法

### 1. タブからアクセス

1. 上部のタブバーから **取引先責任者** タブをクリック
2. 「最近の取引先責任者」リストから確認
3. または「Go!」ボタンの横の検索ボックスで検索

### 2. グローバル検索

1. 上部の検索ボックスに名前やメールアドレスを入力
2. Enterキーを押して検索
3. 検索結果から該当レコードをクリック

## 同期データの確認ポイント

### 基本情報

MarkMailから同期されたコンタクトには以下の情報が含まれます：

| フィールド名 | Salesforceフィールド | 例                                   |
| ------------ | -------------------- | ------------------------------------ |
| 姓           | LastName             | Doe                                  |
| 名           | FirstName            | John                                 |
| メール       | Email                | john.doe@example.com                 |
| MarkMail ID  | MarkMail_ID\_\_c     | a700ecd9-5fa0-4333-addd-6dd059cd8122 |

### カスタムフィールドの表示

**MarkMail_ID\_\_c** フィールドが表示されない場合：

#### Lightning Experienceの場合

1. **設定**（歯車アイコン）→ **設定** をクリック
2. **オブジェクトマネージャ** → **取引先責任者** を選択
3. **ページレイアウト** → 使用中のレイアウトを編集
4. 左側のフィールドパレットから **MarkMail ID** を探す
5. 詳細セクションにドラッグ&ドロップ
6. **保存** をクリック

#### Classic UIの場合

1. **設定** → **ビルド** → **カスタマイズ** → **取引先責任者**
2. **ページレイアウト** をクリック
3. 該当レイアウトの **編集** をクリック
4. **MarkMail ID** フィールドをレイアウトに追加
5. **保存** をクリック

## 一括同期データの確認

### リストビューの作成

大量のデータを同期した場合、専用のリストビューを作成すると便利です：

1. **取引先責任者** タブで **新規** リストビューを作成
2. 名前：「MarkMail同期済み」
3. フィルター条件：
   - **MarkMail ID** が **空白ではない**
4. 表示する項目：
   - 氏名
   - メール
   - MarkMail ID
   - 作成日

### レポートの作成

同期状況を分析するためのレポート作成：

1. **レポート** タブ → **新規レポート**
2. レポートタイプ：**取引先責任者**
3. フィルター：
   - MarkMail IDが空白ではない
   - 作成日が今日
4. グループ化：作成日（日付）

## トラブルシューティング

### データが見つからない場合

1. **すべてのデータを表示**

   - リストビューで「すべての取引先責任者」を選択
   - 検索時に「すべての項目」を検索対象に含める

2. **権限の確認**

   - プロファイルで取引先責任者の参照権限があるか確認
   - MarkMail_ID\_\_cフィールドの参照権限があるか確認

3. **同期状況の確認**
   ```bash
   # MarkMail APIで同期ログを確認
   curl -X GET http://localhost:3000/api/crm/sync/status \
     -H "Authorization: Bearer YOUR_TOKEN"
   ```

### カスタムフィールドが表示されない場合

1. **フィールドレベルセキュリティ**

   - 設定 → セキュリティ → フィールドアクセシビリティ
   - 取引先責任者 → MarkMail ID
   - プロファイルごとの表示設定を確認

2. **ページレイアウト**
   - フィールドがページレイアウトに追加されているか確認
   - 複数のレイアウトがある場合は、使用中のレイアウトを確認

## 便利な機能

### 関連リストの活用

取引先責任者の詳細ページで、以下の関連リストが確認できます：

- 活動履歴
- キャンペーン履歴
- ケース
- 商談

### データのエクスポート

1. リストビューから **エクスポート** ボタンをクリック
2. CSV形式でダウンロード可能
3. MarkMail IDを含めてエクスポートし、データの整合性確認に使用

### 一括更新

1. リストビューで複数レコードを選択
2. **編集** をクリックして一括更新
3. タグ付けやステータス変更などに活用

## 関連ドキュメント

- [Salesforce Setup Manual](./salesforce-setup-manual.md) - 英語版セットアップガイド
- [Salesforce Integration Status](./salesforce-integration-status.md) - 統合実装ステータス
